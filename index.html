
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>作業フローモックアップ（4ステップ）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Favicon（任意。404が気になる場合は配置してください） -->
  <link rel="icon" href="./favicon.ico" />

  <!-- スタイル -->
  <link rel="stylesheet" href="./styles.css" />

  <!-- Supabase JS v2 CDN（正しいscriptタグ） -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- アプリ本体（defer推奨） -->
  <script src="./app.js" defer></script>
</head>
<body>
  <header class="header">
    <button id="menuBtn" class="menu-btn" aria-label="メニュー">☰</button>
    <h1 class="app-title">作業フローモックアップ（4ステップ）</h1>
    <button id="voiceBtn" class="menu-btn" aria-label="音声検知開始">🎙️</button>
  </header>

  <!-- スライドメニュー（省略せずそのまま） -->
  <nav id="sideMenu" class="side-menu" aria-hidden="true">
    <ul class="menu-list">
      <li><button class="menu-link-top" data-target="cell-passaging"><span class="menu-ico">🧪</span><span class="menu-link-top-text">細胞継代作業</span></button></li>
      <li class="menu-section"><span class="menu-ico">🔧</span><span class="menu-section-text">基礎編</span></li>
      <li><button class="menu-link" data-target="room-entry"><span class="menu-ico">🚪</span>入室の仕方</button></li>
      <li><button class="menu-link" data-target="labcoat"><span class="menu-ico">🥼</span>白衣の着方</button></li>
      <li><button class="menu-link" data-target="handwash"><span class="menu-ico">🧼</span>手洗いの仕方</button></li>
      <li class="menu-section"><span class="menu-ico">⚙️</span><span class="menu-section-text">標準作業編</span></li>
      <li><button class="menu-link" data-target="xx-task"><span class="menu-ico">🛠️</span>XX作業</button></li>
      <li><button class="menu-link" data-target="yy-task"><span class="menu-ico">🧰</span>YY作業</button></li>
      <li class="menu-section"><span class="menu-ico">🎬</span><span class="menu-section-text">NG集</span></li>
      <li><button class="menu-link" data-target="ng-collection"><span class="menu-ico">📼</span>NG集</button></li>
      <li class="menu-section"><span class="menu-ico">📷</span><span class="menu-section-text">かたちスキャン</span></li>
      <li><button class="menu-link" data-target="shape-scan"><span class="menu-ico">🎥</span>かたちスキャン</button></li>
    </ul>
  </nav>
  <div id="overlay" class="overlay" aria-hidden="true"></div>

  <!-- レイアウト（左：カメラ／右：手順＋AI） -->
  <main class="layout">
    <section class="camera">
      <video id="cameraVideo" class="camera-video" playsinline muted></video>
      <div id="cameraFallback" class="camera-fallback" hidden>
        カメラ/マイクの取得に関する注意がここに表示されます。
      </div>
    </section>

    <section class="right-stack">
      <div class="step-panel" aria-live="polite">
        <div class="step-body">
          <div class="step-meta">
            <div>作業名：<strong id="taskName">—</strong></div>
            <div>工程：<strong id="processName">—</strong></div>
            <div>ステップ：<strong id="stepIndex">—</strong>/<strong id="stepTotal">—</strong></div>
          </div>
          <ol id="stepDesc" class="step-list"></ol>
          <div class="resources"><span>使用器具：</span><span id="tools">—</span></div>
          <div class="resources"><span>使用溶液：</span><span id="solutions">—</span></div>
          <div id="cautionNote" class="caution-note" hidden></div>
        </div>
        <div class="step-actions">
          <button id="playBtn" class="btn primary" data-video-file=""><span class="btn-label">動画再生</span></button>
          <button id="nextBtn" class="btn"><span class="btn-label">次へ進む</span></button>
        </div>
      </div>

      <div class="assistant-panel">
        <div class="assistant-header">
          <div>AIアシスタント</div>
          <div class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
        </div>
        <div id="chatArea" class="assistant-body" role="log" aria-live="polite"></div>
        <div class="assistant-input">
          <input id="chatInput" type="text" placeholder="質問があれば入力してください…" />
          <button id="sendBtn" class="btn">送信</button>
        </div>
      </div>
    </section>
  </main>
</body>
</html>
